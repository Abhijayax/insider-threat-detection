<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Insider Threat Detection System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { 
            margin: 0; 
            padding: 0;
            font-family: system-ui, -apple-system, sans-serif;
        }
        .chart-bar { 
            transition: all 0.3s ease; 
        }
        .chart-bar:hover { 
            opacity: 0.8; 
        }
        .user-card {
            transition: all 0.2s ease;
        }
        .user-card:hover {
            transform: translateX(4px);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 text-white min-h-screen p-6">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="mb-8">
            <div class="flex items-center gap-3 mb-2">
                <svg class="w-10 h-10 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                </svg>
                <h1 class="text-4xl font-bold">Insider Threat Detection System</h1>
            </div>
            <p class="text-blue-200">Unsupervised Machine Learning for Behavioral Anomaly Detection</p>
        </div>

        <!-- Model Selection -->
        <div class="bg-slate-800/50 backdrop-blur rounded-lg p-6 mb-6 border border-blue-500/30">
            <div class="flex items-center justify-between flex-wrap gap-4">
                <div>
                    <label class="block text-sm font-medium mb-2">Detection Model</label>
                    <select id="modelSelect" class="bg-slate-700 border border-slate-600 rounded px-4 py-2 text-white">
                        <option value="isolation_forest">Isolation Forest ‚≠ê</option>
                        <option value="one_class_svm">One-Class SVM</option>
                        <option value="autoencoder">Autoencoder</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium mb-2">Top-K Users</label>
                    <input id="topKInput" type="number" value="10" min="1" max="50" class="bg-slate-700 border border-slate-600 rounded px-4 py-2 text-white w-24">
                </div>
                <div class="flex gap-6">
                    <div class="text-center">
                        <div id="precisionDisplay" class="text-2xl font-bold text-green-400">80.0%</div>
                        <div class="text-sm text-gray-400">Precision@10</div>
                    </div>
                    <div class="text-center">
                        <div id="fprDisplay" class="text-2xl font-bold text-yellow-400">20.0%</div>
                        <div class="text-sm text-gray-400">False Positive Rate</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Stats Cards -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
            <div class="bg-gradient-to-br from-red-500/20 to-red-600/20 rounded-lg p-4 border border-red-500/30">
                <div class="flex items-center justify-between">
                    <div>
                        <div class="text-sm text-gray-300">High Risk Users</div>
                        <div id="highRiskCount" class="text-3xl font-bold text-red-400">8</div>
                    </div>
                    <svg class="w-10 h-10 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                    </svg>
                </div>
            </div>
            <div class="bg-gradient-to-br from-blue-500/20 to-blue-600/20 rounded-lg p-4 border border-blue-500/30">
                <div class="flex items-center justify-between">
                    <div>
                        <div class="text-sm text-gray-300">Total Users</div>
                        <div class="text-3xl font-bold text-blue-400">50</div>
                    </div>
                    <svg class="w-10 h-10 text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"></path>
                    </svg>
                </div>
            </div>
            <div class="bg-gradient-to-br from-purple-500/20 to-purple-600/20 rounded-lg p-4 border border-purple-500/30">
                <div class="flex items-center justify-between">
                    <div>
                        <div class="text-sm text-gray-300">Avg Risk Score</div>
                        <div id="avgRiskScore" class="text-3xl font-bold text-purple-400">45.2</div>
                    </div>
                    <svg class="w-10 h-10 text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                    </svg>
                </div>
            </div>
            <div class="bg-gradient-to-br from-green-500/20 to-green-600/20 rounded-lg p-4 border border-green-500/30">
                <div class="flex items-center justify-between">
                    <div>
                        <div class="text-sm text-gray-300">Detection Rate</div>
                        <div id="detectionRate" class="text-3xl font-bold text-green-400">80%</div>
                    </div>
                    <svg class="w-10 h-10 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                    </svg>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
            <!-- Top Risky Users -->
            <div class="bg-slate-800/50 backdrop-blur rounded-lg p-6 border border-blue-500/30">
                <h2 class="text-xl font-bold mb-4 flex items-center gap-2">
                    <svg class="w-5 h-5 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path>
                    </svg>
                    <span id="topKTitle">Top 10 Risky Users</span>
                </h2>
                <div id="userList" class="space-y-2 max-h-96 overflow-y-auto"></div>
            </div>

            <!-- Feature Analysis -->
            <div class="bg-slate-800/50 backdrop-blur rounded-lg p-6 border border-blue-500/30">
                <h2 class="text-xl font-bold mb-4">Feature Contribution Analysis</h2>
                <div id="featureChart" class="space-y-3"></div>
            </div>
        </div>

        <!-- Selected User Detail -->
        <div id="userDetail" class="bg-slate-800/50 backdrop-blur rounded-lg p-6 border border-blue-500/30 hidden">
            <h2 class="text-xl font-bold mb-4">
                User Profile: <span id="selectedUserId"></span>
                <span id="threatBadge" class="ml-2 text-red-400"></span>
            </h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4" id="userMetrics"></div>
        </div>

        <!-- Footer -->
        <div class="mt-8 text-center text-sm text-gray-400">
            <p>Unsupervised ML Models: Isolation Forest ‚Ä¢ One-Class SVM ‚Ä¢ Autoencoder</p>
            <p class="mt-1">Dataset: CERT Insider Threat Dataset (Synthetic Demo)</p>
        </div>
    </div>

    <script>
        // Generate synthetic user data
        function generateUsers() {
            const users = [];
            for (let i = 0; i < 50; i++) {
                const isAnomalous = i < 5;
                const baseScore = isAnomalous ? Math.random() * 20 + 70 : Math.random() * 40 + 20;
                
                users.push({
                    id: `USER_${String(i + 1).padStart(3, '0')}`,
                    score: baseScore,
                    isAnomalous: isAnomalous,
                    loginCount: Math.floor(Math.random() * 40 + (isAnomalous ? 30 : 10)),
                    offHours: Math.random() * (isAnomalous ? 0.5 : 0.2),
                    fileAccess: Math.floor(Math.random() * 150 + (isAnomalous ? 150 : 30)),
                    emailCount: Math.floor(Math.random() * 60 + (isAnomalous ? 60 : 15)),
                    usbUsage: Math.floor(Math.random() * (isAnomalous ? 15 : 3)),
                    sensitiveFiles: Math.floor(Math.random() * (isAnomalous ? 20 : 3))
                });
            }
            return users.sort((a, b) => b.score - a.score);
        }

        const allUsers = generateUsers();
        let selectedUser = null;

        // Render user list
        function renderUserList(topK) {
            const userList = document.getElementById('userList');
            const topKTitle = document.getElementById('topKTitle');
            topKTitle.textContent = `Top ${topK} Risky Users`;
            userList.innerHTML = '';
            
            const users = allUsers.slice(0, topK);
            
            users.forEach((user, idx) => {
                const div = document.createElement('div');
                div.className = 'user-card flex items-center justify-between p-3 rounded bg-slate-700/50 hover:bg-slate-700 cursor-pointer transition-all';
                div.onclick = () => selectUser(user);
                
                div.innerHTML = `
                    <div class="flex items-center gap-3">
                        <div class="${idx < 3 ? 'bg-red-500/30 text-red-300' : 'bg-yellow-500/30 text-yellow-300'} w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold">
                            ${idx + 1}
                        </div>
                        <div>
                            <div class="font-medium">${user.id}</div>
                            <div class="text-xs text-gray-400">
                                ${user.isAnomalous ? 'üö® Confirmed Threat' : '‚ö†Ô∏è Suspicious'}
                            </div>
                        </div>
                    </div>
                    <div class="text-right">
                        <div class="text-lg font-bold ${user.score > 80 ? 'text-red-400' : 'text-yellow-400'}">
                            ${user.score.toFixed(1)}
                        </div>
                        <div class="text-xs text-gray-400">Risk Score</div>
                    </div>
                `;
                userList.appendChild(div);
            });
        }

        // Select user for detail view
        function selectUser(user) {
            selectedUser = user;
            const detailDiv = document.getElementById('userDetail');
            const userIdSpan = document.getElementById('selectedUserId');
            const threatBadge = document.getElementById('threatBadge');
            const metricsDiv = document.getElementById('userMetrics');
            
            detailDiv.classList.remove('hidden');
            userIdSpan.textContent = user.id;
            threatBadge.textContent = user.isAnomalous ? 'üö® CONFIRMED THREAT' : '';
            
            metricsDiv.innerHTML = `
                <div class="bg-slate-700/50 rounded p-3">
                    <div class="flex items-center gap-2 text-sm text-gray-400 mb-1">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                        Login Activity
                    </div>
                    <div class="text-2xl font-bold">${user.loginCount}</div>
                    <div class="text-xs text-yellow-400">${(user.offHours * 100).toFixed(0)}% off-hours</div>
                </div>
                <div class="bg-slate-700/50 rounded p-3">
                    <div class="flex items-center gap-2 text-sm text-gray-400 mb-1">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                        File Access
                    </div>
                    <div class="text-2xl font-bold">${user.fileAccess}</div>
                    <div class="text-xs text-red-400">${user.sensitiveFiles} sensitive</div>
                </div>
                <div class="bg-slate-700/50 rounded p-3">
                    <div class="flex items-center gap-2 text-sm text-gray-400 mb-1">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
                        Email Activity
                    </div>
                    <div class="text-2xl font-bold">${user.emailCount}</div>
                    <div class="text-xs text-yellow-400">${Math.floor(Math.random() * 30 + 20)}% new recipients</div>
                </div>
                <div class="bg-slate-700/50 rounded p-3">
                    <div class="flex items-center gap-2 text-sm text-gray-400 mb-1">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path></svg>
                        USB Usage
                    </div>
                    <div class="text-2xl font-bold">${user.usbUsage}</div>
                    <div class="text-xs text-red-400">${(user.usbUsage * 350).toFixed(0)} MB copied</div>
                </div>
            `;
            
            // Scroll to detail
            detailDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Render feature chart
        function renderFeatureChart() {
            const features = [
                { name: 'Off-Hours Access', value: 85, color: 'bg-red-500' },
                { name: 'Failed Logins', value: 72, color: 'bg-red-400' },
                { name: 'Rare File Access', value: 68, color: 'bg-orange-500' },
                { name: 'Access Spike', value: 55, color: 'bg-yellow-500' },
                { name: 'Sensitive Access', value: 45, color: 'bg-blue-500' },
                { name: 'New Recipients', value: 38, color: 'bg-blue-400' },
                { name: 'USB Activity', value: 32, color: 'bg-indigo-500' },
                { name: 'Activity Variance', value: 28, color: 'bg-purple-500' }
            ];

            const chart = document.getElementById('featureChart');
            chart.innerHTML = '';

            features.forEach(feature => {
                const div = document.createElement('div');
                div.innerHTML = `
                    <div class="flex items-center gap-3">
                        <div class="w-36 text-sm text-gray-300">${feature.name}</div>
                        <div class="flex-1 bg-slate-700 rounded-full h-6 overflow-hidden">
                            <div class="chart-bar h-full ${feature.color}" style="width: ${feature.value}%"></div>
                        </div>
                        <div class="w-12 text-sm font-bold">${feature.value}%</div>
                    </div>
                `;
                chart.appendChild(div);
            });
        }

        // Update metrics based on model selection
        function updateMetrics(model) {
            const metrics = {
                isolation_forest: { precision: 80.0, fpr: 20.0 },
                one_class_svm: { precision: 70.0, fpr: 30.0 },
                autoencoder: { precision: 65.0, fpr: 35.0 }
            };

            const m = metrics[model];
            document.getElementById('precisionDisplay').textContent = `${m.precision}%`;
            document.getElementById('fprDisplay').textContent = `${m.fpr}%`;
            document.getElementById('detectionRate').textContent = `${m.precision}%`;
            
            // Update high risk count based on precision
            const highRisk = Math.round(10 * (m.precision / 100));
            document.getElementById('highRiskCount').textContent = highRisk;
        }

        // Event listeners
        document.getElementById('modelSelect').addEventListener('change', (e) => {
            updateMetrics(e.target.value);
        });

        document.getElementById('topKInput').addEventListener('input', (e) => {
            const topK = parseInt(e.target.value) || 10;
            renderUserList(Math.max(1, Math.min(50, topK)));
        });

        // Initial render
        renderUserList(10);
        renderFeatureChart();
        
        console.log('‚úì Dashboard loaded successfully!');
    </script>
</body>
</html>
